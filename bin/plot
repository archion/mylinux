#!/bin/bash
#file=`basename "$1"`
#cd `dirname "$1"`
for f in "$@"
do
	file=${f##*/}
	cd ${f/$file/.}
	if ! [ -f "${file/.*}".plt ]; then
		sed -n "1,/#data/p" "$file" >"${file/.*}".plt
		sed -i "s/\"-\"/\"$file\"/g" "${file/.*}".plt
		sed -i "s/\"-\.\"/\"${file%.*}\.\"/g" "${file/.*}".plt
	fi
	sed -i "1,/#data/s/^/#/" "$file"
	gnuplot "${file/.*}".plt
	if grep "##data" "$file" >/dev/null; then
		sed -i "1,/#data/s/^#//" "$file"
	fi
	#rm plot.plt
done
